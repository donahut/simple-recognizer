(ns simple-recognizer.core
  (:require [clojure.math.numeric-tower :as math])
  (:gen-class))

(import
  '(edu.cmu.sphinx.frontend DataBlocker)
  '(edu.cmu.sphinx.frontend FrontEnd)
  '(edu.cmu.sphinx.frontend DataStartSignal)
  '(edu.cmu.sphinx.frontend DataEndSignal)
  '(edu.cmu.sphinx.frontend.endpoint NonSpeechDataFilter)
  '(edu.cmu.sphinx.frontend.endpoint SpeechClassifier)
  '(edu.cmu.sphinx.frontend.endpoint SpeechMarker)
  '(edu.cmu.sphinx.frontend.feature DeltasFeatureExtractor)
  '(edu.cmu.sphinx.frontend.feature LiveCMN)
  '(edu.cmu.sphinx.frontend.filter Preemphasizer)
  '(edu.cmu.sphinx.frontend.frequencywarp MelFrequencyFilterBank)
  '(edu.cmu.sphinx.frontend.transform DiscreteCosineTransform)
  '(edu.cmu.sphinx.frontend.transform DiscreteFourierTransform)
  '(edu.cmu.sphinx.frontend.util AudioFileDataSource)
  '(edu.cmu.sphinx.frontend.window RaisedCosineWindower)
  '(edu.cmu.sphinx.util LogMath)
  '(java.util.logging Logger)
  '(java.util.logging Level)
  '(java.net URL)
  '(java.io FileInputStream))

;; COLOR FEATURE VECTORS

(def red  [[-7.186091 2.0068178 1.1958194 0.7776593 0.15340246 -0.28096268 -0.36421615 -0.34346336 -0.2743734 -0.042494718 -0.018574903 -0.016145593 -0.06978092] [-7.788824 1.5159585 0.7342069 0.5904415 0.25758186 -0.06838063 -0.20785747 -0.08709925 -0.095992476 -0.18947412 -0.15363576 -0.15995964 -0.08521907] [-8.179525 1.312304 0.577111 0.48192877 0.26548395 -0.05842051 -0.24538507 -0.3787669 -0.21817797 -0.16214865 -0.20724216 -0.11693629 0.031160507] [-8.316525 1.1090845 0.5472979 0.38612285 0.20151551 0.09539954 -0.2896853 -0.3179063 -0.25443986 0.004055265 -0.06761557 0.052114174 -0.049960513] [-8.001158 1.3633763 0.66740817 0.62506884 0.27076477 -0.22150472 -0.3879031 -0.3953229 -0.16220981 0.06170499 -0.021933284 0.12607974 -0.13001688] [-7.05012 2.226111 1.2625289 0.66068804 0.014032832 -0.44844407 -0.36149853 -0.2176555 -0.137548 -0.030715745 -0.038414888 0.075767405 -0.108000435] [-6.9193707 2.2257242 1.1475534 0.5059534 -0.08948884 -0.48887917 -0.4737675 -0.22776353 0.05914787 0.077773616 0.019738566 0.04312781 -0.18707575] [-6.379832 2.4518387 1.2699869 0.57596767 -0.16661969 -0.4219179 -0.5661918 -0.2353477 0.043801874 0.225338 0.08337455 -0.123213015 -0.19921407] [-5.8883615 2.630972 0.99262726 0.37914753 -0.20556088 -0.57364565 -0.50768137 -0.08845887 0.115098216 0.15401833 -0.019771405 -0.14976963 -0.3027231] [-5.6700497 2.7067664 0.97206604 0.26002187 -0.27815732 -0.68532705 -0.44539553 0.09482869 0.21795645 0.15994623 0.009596552 -0.09829759 -0.3354966] [-4.693129 2.6933882 0.8455165 0.08061913 -0.4440304 -0.6249468 -0.39434522 0.08878505 0.26984406 0.1352675 -0.09333064 -0.19448358 -0.3646349] [-5.367496 2.7518177 0.8683087 0.0047039087 -0.566633 -0.6850152 -0.37863958 0.3140964 0.35944143 0.1543545 -0.20610492 -0.27230975 -0.41200534] [-4.7879143 2.8732016 0.86058354 -0.009454896 -0.45332578 -0.6063503 -0.54239005 0.31030166 0.45295018 0.14773451 -0.3012708 -0.3090651 -0.4177609] [-5.2552867 2.6123767 0.82712805 0.03505499 -0.64254296 -0.68225795 -0.36156526 0.36290792 0.48971388 0.023795262 -0.42838186 -0.2971561 -0.32342643] [-4.6118236 2.7208471 0.64707214 0.053528484 -0.4571771 -0.61711895 -0.31029356 0.44761625 0.49274182 -0.1202958 -0.3653187 -0.35746038 -0.41037586] [-3.9816966 2.8854146 0.43346718 -0.22378047 -0.40418756 -0.42285702 -0.29854503 0.3212854 0.37550062 -0.30271378 -0.5588494 -0.28857327 -0.116604485] [-4.163544 2.8606853 0.35033903 -0.21931234 -0.4654462 -0.34521136 -0.2010132 0.50376016 0.47024888 -0.2789664 -0.7801709 -0.34499156 -0.1413519] [-3.7862298 2.7181628 0.256563 -0.2250168 -0.1396131 -0.3014413 -0.29398623 0.31210682 0.46074474 -0.16912498 -0.6862254 -0.40514207 -0.1710397] [-4.2407055 2.7288551 0.2183015 -0.36489534 -0.30435166 -0.3218251 -0.2018993 0.41313887 0.5090752 -0.45930257 -0.7362813 -0.4974923 -0.10080772] [-3.5128949 2.827486 0.17332697 -0.22019942 -0.120141186 -0.33257347 -0.30594862 0.3763633 0.5044845 -0.41273624 -0.7606092 -0.37483448 0.01757512] [-2.8526132 2.7393878 -0.4186837 -0.44003034 -0.063570544 -0.10896522 -0.15455757 0.26787755 0.16425742 -0.58528423 -0.54509383 -0.031227501 -0.14033115] [-2.2588878 2.9055462 -0.6895099 -0.49837887 0.020838149 -0.09547686 -0.042266726 0.3011658 0.27218497 -0.54867816 -0.7416019 -0.028564015 -0.13902242] [-2.7895865 2.684126 -0.4344175 -0.4056857 0.077451386 0.08043902 -0.20754579 0.1456788 0.25170663 -0.26200023 -0.6629648 -0.31290162 -0.13545506] [-2.8510451 2.4465754 -0.2780067 -0.36923584 0.11775732 0.12497831 -0.19349308 0.10472726 0.20585476 -0.35213122 -0.7376152 -0.3875646 -0.21458349] [-2.2154028 2.6348665 -0.57553625 -0.4009338 0.22105876 0.24548718 -0.2844784 0.026428297 0.20698065 -0.33290926 -0.6141513 -0.1837802 -0.22422141] [-2.9040864 2.5949316 -0.5693949 -0.44855672 0.19257799 0.295167 -0.17636345 -0.044830978 0.21867551 -0.29602736 -0.6980919 -0.41926765 -0.3181364] [-2.2319505 2.6699069 -0.75178415 -0.4691352 0.40498525 0.3264427 -0.23760837 0.033155076 0.17739807 -0.20745686 -0.7387761 -0.406073 -0.22188465] [-2.6736655 2.499952 -0.69127136 -0.37848017 0.40553337 0.32350722 -0.30191115 -0.10669761 0.19260561 -0.20175025 -0.66869295 -0.28480622 -0.34541875] [-2.1310196 2.4658794 -0.77525854 -0.25818264 0.38864845 0.43381214 -0.37610495 -0.14313981 0.17197703 -0.24934119 -0.69304675 -0.31027815 -0.3127873] [-2.1967087 2.6035047 -0.7209561 -0.32623 0.14174955 0.21039905 -0.14232682 -0.21281731 0.15928495 -0.09439626 -0.6647064 -0.2319584 -0.18447131] [-2.287032 2.5129108 -0.7510246 -0.21802461 0.20545268 0.36021608 -0.09690953 -0.32551697 0.10041334 -0.17725259 -0.71861184 -0.2877875 -0.3352025] [-2.0895038 2.5559163 -0.6893431 -0.2978402 0.205071 0.35734302 -0.2698196 -0.46943876 0.25961775 -0.06483697 -0.75254613 -0.23785384 -0.22774781] [-2.4483695 2.3856144 -0.6848721 -0.3265305 0.20441847 0.4900845 -0.16925804 -0.35517278 0.120976724 -0.2449835 -0.73537844 -0.32633388 -0.2593271] [-2.0853224 2.6244025 -0.69841003 -0.20821013 0.22408757 0.32124358 -0.4351121 -0.3037173 0.34786803 -0.23662837 -0.79449993 -0.3001935 -0.14821923] [-2.5315197 2.4230971 -0.65967953 -0.28815714 0.21086766 0.39369404 -0.15821987 -0.36211762 0.1358416 -0.25214708 -0.86147845 -0.36094567 -0.15184452] [-2.242263 2.4974606 -0.7329781 -0.13288724 0.19905844 0.40742853 -0.2094431 -0.47851166 0.040163625 -0.103921555 -0.6812468 -0.31192157 -0.28380555] [-2.4481003 2.3784413 -0.6982865 -0.37629506 0.20866483 0.41844484 -0.17752774 -0.37111643 0.077893294 -0.13701917 -0.5939574 -0.405434 -0.24705991] [-2.3281145 2.588646 -0.73419595 -0.3873523 0.25263 0.439536 -0.2296353 -0.2960893 0.21328828 -0.21349227 -0.8150614 -0.40991995 -0.30070198] [-2.3653884 2.4220116 -0.69825673 -0.21092767 0.22336628 0.35376084 -0.26508492 -0.41610095 0.069729105 -0.089751676 -0.66114956 -0.28724197 -0.2517284] [-2.4569483 2.3568263 -0.6343537 -0.10809014 0.15945223 0.38650265 -0.14612536 -0.45027262 0.067768455 -0.03204883 -0.75312924 -0.390665 -0.29539815] [-2.2293751 2.4064124 -0.7225316 -0.15746227 0.19697046 0.45804176 -0.21325026 -0.31414053 0.0968113 -0.080769844 -0.74804634 -0.47781304 -0.26580697] [-2.6717536 2.3973255 -0.63131076 -0.2802121 0.118226595 0.49617016 -0.07489104 -0.27614567 0.13406402 -0.13302617 -0.80857223 -0.56854075 -0.40575722] [-2.420741 2.556341 -0.42986745 -0.19720031 -0.2801993 0.23584998 0.10015497 -0.20621349 0.036521137 -0.23040527 -0.626523 -0.4210438 -0.27963632] [-2.7752237 2.223475 -0.73240495 -0.23513748 0.08636158 0.5934722 -0.007317894 -0.33405828 0.17188637 -0.21789812 -0.7149951 -0.5276397 -0.3427431] [-2.1976485 2.3294444 -0.8258459 -0.20965588 0.310351 0.5646229 -0.1207732 -0.5071126 0.09399775 -0.07130122 -0.6602123 -0.4155622 -0.25364128] [-2.717673 2.229899 -0.61716413 -0.22837408 0.024570497 0.4863812 -0.025438111 -0.42124766 0.03259515 -0.16382784 -0.61324483 -0.34494343 -0.18342066] [-2.6096802 2.4881523 -0.5231891 -0.38837475 -0.12794016 0.41198665 0.22192535 -0.27619183 0.026873149 -0.23771828 -0.68992394 -0.26739383 -0.26447216] [-2.6835997 2.3614907 -0.6168318 -0.3731534 0.14467628 0.43930393 -0.2812789 -0.19644348 0.18094814 -0.12235423 -0.52677214 -0.40129474 -0.15767151] [-2.7661471 2.2642674 -0.6570115 -0.36145976 0.3389085 0.6052634 -0.17135212 -0.10855382 0.21206073 -0.2755669 -0.5679322 -0.4667179 -0.33954528] [-3.014739 2.273348 -0.6850041 -0.55020285 0.21792743 0.6660816 -0.08706448 -0.161285 0.24747555 -0.2398978 -0.45332524 -0.34615007 -0.22202013] [-3.3940835 2.1656046 -0.69020766 -0.49323574 0.25289655 0.66651297 -0.13053834 -0.074515164 0.33976603 -0.024560068 -0.46865258 -0.5081167 -0.22608273] [-3.4950964 2.2742915 -0.703675 -0.59857005 0.31875956 0.6043286 -0.22047287 -0.16813113 0.31243917 0.029096758 -0.42829603 -0.30329853 -0.09298638] [-4.220733 1.8780352 -0.7385085 -0.59764826 0.38362285 0.64045 0.0060955766 -0.104571626 0.28641304 -0.07518572 -0.33231193 -0.2501978 -0.12945102] [-4.6817665 1.5245152 -0.78486687 -0.63176334 0.27257004 0.49706224 -0.042347774 -0.088991374 0.20865442 0.029055687 -0.22584997 -0.14436123 0.022523727] [-5.179623 1.5374652 -0.5423124 -0.52078223 0.02772887 0.22337969 -0.009726555 -0.080591775 0.12167915 -0.007652379 -0.15458047 -0.11918155 -0.043928463] [-5.2262545 1.5363214 -0.43528637 -0.46000963 0.20096232 0.4138727 -0.06770747 -0.059101816 0.14957482 0.11973275 -0.07345467 -0.10166539 -0.15297464] [-5.4444976 1.4943441 -0.3165433 -0.42390665 0.16341 0.37776595 0.0075266724 -0.07486269 0.056334667 -0.061810657 -0.3418066 -0.35101163 -0.16182706] [-5.342005 1.5445229 -0.1996526 -0.16139412 0.15550195 0.31292245 0.05278519 -0.08521522 0.044596143 -0.038206007 -0.36679024 -0.2295737 -0.017968582] [-5.4571342 1.395847 -0.14559822 -0.16347674 0.042193837 0.30578142 0.10100916 0.019935623 -0.06825272 -0.032749232 -0.2758843 -0.26655504 -0.2506895] [-5.70932 1.3213998 -0.15921251 -0.35798165 0.06698068 0.44301692 0.14584742 0.083310015 -0.039741073 -0.043641035 -0.3331037 -0.35272312 -0.260213] [-5.7860246 1.3553882 -0.09896106 -0.13955782 0.08233607 0.2954111 0.0118686035 -0.057189617 -0.10267313 -0.0788633 -0.20424168 -0.33312836 -0.2970668] [-6.1716824 1.2201935 -0.13317358 -0.036497835 0.1946496 0.33667403 0.14608957 -0.024323722 -0.1089628 -0.1742871 -0.2560663 -0.27432594 -0.24225426] [-6.1210938 0.9958513 -0.17790811 -0.13645852 0.059242778 0.32776347 0.16497037 0.09213823 -0.030716237 -0.22224234 -0.21478215 -0.27032095 -0.25944054] [-6.2115026 0.8646405 -0.15373063 -0.021766266 0.10914755 0.27851173 0.1584605 0.094816 -0.13013215 -0.18664235 -0.26470292 -0.33035287 -0.23938815] [-6.342112 0.89264697 -0.16552062 -0.072465785 0.017801303 0.3122718 0.17687362 0.046706278 -0.16147421 -0.1627157 -0.3454489 -0.16639107 -0.15669228] [-6.021033 1.1536283 -0.17161463 -0.06684887 0.20186318 0.10232251 0.034737464 0.023257965 -0.04875908 -0.08790762 -0.22528215 -0.2505257 -0.13847779] [-4.5264764 1.6801546 -0.7998892 -0.4549935 0.4992935 0.5656286 -0.15885457 -0.23686464 -0.07939458 -0.11522342 -0.41736066 -0.19916081 -0.15781862] [-4.379136 1.7301894 -0.83637935 -0.4612577 0.62830883 0.7771423 -0.2700243 -0.2444366 -0.05167831 -0.13357581 -0.40548393 -0.28630692 -0.0364571] [-5.0607944 1.2532632 -0.83155704 -0.31683135 0.3808239 0.6201445 -0.059767224 -0.27169234 0.058761295 -0.028036632 -0.40613797 -0.3776027 -0.122959316] [-4.538768 1.1440098 -0.9768828 -0.54443544 0.35462895 0.8528324 -0.0458858 -0.061113797 0.39535508 -0.27947092 -0.65021765 -0.3953893 -0.11608297] [-4.7024293 1.044842 -1.0960076 -0.5420732 0.17547001 0.8145305 0.1876815 -0.053054888 0.337704 -0.2691051 -0.5698932 -0.32794595 -0.15362336] [-4.5089493 1.2895795 -1.2578087 -0.69214594 0.40341723 0.88349646 0.031440042 -0.06801449 0.24201688 -0.31567547 -0.63265544 -0.38054028 -0.06483767] [-5.009088 1.4166504 -0.7345745 -0.6036445 0.14074557 0.6087742 0.099719346 -0.06618525 0.22489703 -0.11876406 -0.62071764 -0.39488414 -0.12172764] [-5.3936205 1.1340522 -0.7718206 -0.38719395 0.31360084 0.5107865 0.031011708 -0.07871695 0.17588884 -0.094804056 -0.3550014 -0.31829914 -0.00494025] [-6.002665 0.8417064 -0.85695136 -0.38454264 0.25834185 0.5567289 0.10223155 -0.04196385 0.029842006 -0.17841548 -0.25039902 -0.37223738 -0.2170552] [-6.185344 0.6787912 -0.76593155 -0.46225867 0.23808362 0.5447646 0.07197018 -0.045362577 -0.0054819346 -0.25784135 -0.4587892 -0.42870983 -0.2248164] [-6.3646336 0.8264164 -0.7142414 -0.49345002 0.0050602434 0.36843258 0.18697396 0.078306824 0.11805726 -0.11895346 -0.286374 -0.29702803 -0.12421931] [-6.5815287 0.7346819 -0.5998927 -0.4178447 0.15977743 0.40620264 0.22513126 0.06794805 0.021733213 0.10062626 -0.21336037 -0.30107442 -0.07426691] [-6.679868 0.74103194 -0.44304612 -0.41942093 0.09396475 0.29559457 0.34849513 0.09329633 0.009575478 0.04135917 -0.29195163 -0.25518793 -0.02271395] [-6.9390454 0.62257224 -0.42119572 -0.45679477 -0.025078904 0.20566568 0.17196156 0.0023713482 0.052282773 -0.20118071 -0.2759555 -0.17856967 -0.01618152] [-7.0310497 0.49964926 -0.33334285 -0.22913203 -0.15371938 0.14070994 0.15084246 0.13303234 -0.039498344 -0.09974356 -0.25754762 0.011735769 0.08501348] [-7.318517 0.32804266 -0.34879035 -0.31027666 -0.15320656 0.30866626 0.21582402 -0.008771898 -0.044601772 -0.07902541 -0.08793317 -0.084194444 0.028763838] [-7.258048 0.34024712 -0.4251922 -0.2611674 -0.07084304 0.23851217 0.23473333 0.031321697 0.21818788 0.06294038 -0.1412832 -0.08661525 -0.102877356] [-7.173843 0.2923045 -0.46766248 -0.28215954 -0.1357625 0.15673903 0.19117899 0.06447608 0.078916974 -0.038966864 -0.1496327 -0.023688074 -0.00686179]])

(def red2 [[-3.2556505 1.5979993 -0.022747908 0.35234997 -0.694357 0.1009558 -0.06400799 -0.7184757 0.14253512 0.045345113 -0.19607496 -0.013460687 -0.1596049] [-3.7137694 1.528622 0.008028798 0.2634906 -0.5046473 0.10774619 0.003918522 -0.7695252 0.04256894 0.10420419 -0.37666795 -0.08400524 -0.02059511] [-2.795138 2.0870967 -0.050811592 -0.30408952 -0.5768918 0.12859425 0.057863377 -0.6304588 -0.21646754 -0.02189952 -0.32501566 -0.09457344 -0.03145073] [-2.683745 2.58006 -0.2849918 -0.79893106 -0.5130353 0.36278248 -0.07685938 -0.6554799 -0.2890992 -0.10817422 -0.19168726 -0.0835491 0.003112099] [-2.297989 2.6358082 -0.3788737 -0.80124855 -0.39447835 0.4805637 -0.22407319 -0.6410193 -0.40087745 -0.066589765 -1.6252503E-4 -0.12348627 0.018226834] [-1.9480784 2.567193 -0.40903902 -0.80940443 -0.32141843 0.470441 -0.41681057 -0.81821185 -0.3552536 0.05732127 0.03125991 -0.21136607 0.04410629] [-1.4522686 2.4869711 -0.6931223 -0.6001074 -0.17825559 0.37985 -0.68805593 -0.8363778 -0.11607034 0.011136005 -0.018395973 -0.11699556 0.045157168] [-0.8292704 2.3007286 -0.8068489 -0.47268808 -0.3411609 0.5011191 -0.89227927 -0.80589485 0.1834886 -0.1784717 0.020662848 0.0117431665 -0.034760986] [-0.3330693 2.0282686 -0.93415475 -0.25138116 -0.47231075 0.44781926 -1.0278566 -0.69564486 0.34154204 -0.3591317 0.1359939 0.14653295 -0.1575226] [0.07538198 1.9043446 -1.0847025 -0.06658391 -0.5010039 0.26233634 -0.9138495 -0.5935519 0.26898304 -0.33273742 0.21418095 0.1660279 -0.2531089] [0.40681863 1.8153135 -1.2431974 0.19272618 -0.61266553 0.11423014 -0.7592337 -0.63789827 0.16353239 -0.26995286 0.28325456 -0.021177547 -0.19489288] [0.7125321 1.6670413 -1.1954052 0.21772584 -0.65913767 0.0054263184 -0.6178538 -0.6249637 1.3122438E-4 -0.13601318 0.2957267 -0.1172127 -0.21966028] [0.7203619 1.5962543 -1.1241235 0.25887462 -0.74336725 -0.059723534 -0.51585096 -0.68639016 0.117568254 -0.1423681 0.32378715 -0.15442006 -0.16293222] [0.86126524 1.4214438 -1.2467097 0.47543356 -0.9099153 -0.16514693 -0.4160557 -0.6794653 0.09936701 -0.034457155 0.31238213 -0.23407622 -0.08870063] [1.0344223 1.1975285 -1.2429154 0.4824461 -0.77562094 -0.2441097 -0.50848174 -0.56795585 0.04730308 0.11112291 0.22042178 -0.20386986 -0.0046440875] [0.85048205 1.0499569 -1.1907517 0.57251036 -0.86990076 -0.4278659 -0.53486794 -0.39760223 -0.12971713 0.16237277 0.10508012 -0.19244206 0.018636595] [0.48533452 1.119739 -1.0902942 0.53964084 -0.9051923 -0.5226437 -0.4680379 -0.45282686 -0.11944423 0.12322432 0.10372938 -0.1749699 0.042517494] [0.10950032 1.1344371 -0.9342115 0.66265684 -0.8703726 -0.60270286 -0.46575996 -0.35263523 -0.039191358 0.033680674 0.091857255 -0.15354262 0.18348275] [0.09215774 0.9984588 -1.200167 0.5581052 -0.42795438 -0.4924 -0.60458344 -0.44968143 0.070889965 0.04802882 -0.050038654 -0.20456964 0.104972474] [-0.14371663 0.9204515 -1.2233744 0.64212036 -0.40716842 -0.3407214 -0.6243855 -0.4846976 0.0138673 0.030748121 0.050058845 -0.2255342 0.20656107] [-0.06755651 1.0774515 -1.1383209 0.8650262 -0.63282394 -0.36872438 -0.4227319 -0.58290094 0.084455274 -0.17107084 0.05013625 -0.17077543 0.11270932] [0.26104605 1.1356989 -1.1410254 0.90347594 -0.73936063 -0.3938878 -0.5239274 -0.62027144 0.13890211 -0.11422162 0.15136439 -0.13930523 0.2282753] [-1.7980076 1.0350262 -0.7430033 0.6978271 -0.44177216 -0.43892923 -0.31858584 -0.32065707 0.13149598 -0.060869098 -0.028276494 -0.10737411 0.015131742] [-0.5817469 1.2824297 -0.7504384 0.9048867 -0.49352095 -0.2647446 -0.54100007 -0.7094885 0.070628375 0.01903512 0.012819461 -0.09239355 0.11271852] [-2.0858455 1.0022128 -0.5667405 0.7441307 -0.4639275 -0.49216482 -0.5178039 -0.61573213 -0.056195725 -0.031213565 -0.098741546 -0.098925106 0.17641181] [-2.0647938 1.0550694 -0.645209 0.7983466 -0.3613712 -0.35839707 -0.42124605 -0.640015 0.005719622 -0.018614218 -0.20723636 -0.1994775 0.24746402] [-3.32994 0.98142266 -0.295109 0.7817766 -0.047353115 -0.32642007 -0.2917382 -0.40078983 0.14255637 0.14850466 -0.27204105 -0.30207646 0.027269917] [-4.2975183 1.0147327 -0.029895337 0.3302172 -0.16534589 -0.36165285 -0.24550913 -0.35235164 0.045980167 0.29446274 -0.16986513 -0.17040505 0.19560343] [-4.7417183 0.93517816 0.2712314 0.4753913 0.22028576 -0.058904644 -0.15835205 -0.11794531 0.185361 0.19202511 -0.39490438 -0.21029696 0.06315404] [-5.2435102 0.8261705 0.28249583 0.44323042 0.1316229 -0.22115342 -0.37866765 -0.23881036 0.13598469 0.077327445 -0.30332467 -0.01668977 0.1806634] [-5.629713 0.803512 0.3531757 0.31350103 0.026066624 -0.16907491 -0.34778246 -0.1846865 0.20162243 0.032244444 -0.28647837 -0.05472204 0.11928776] [-5.8517003 0.7529271 0.43008873 0.50892633 0.14576943 -0.03589718 -0.19254205 -0.05854613 0.08920023 -0.029047897 -0.26309338 -0.18876673 -0.039356653] [-5.964156 0.77928907 0.5609226 0.38829413 -0.08504365 -0.0440108 -0.08247527 -0.10623368 -0.014843113 -0.113087006 0.029009262 -0.06685077 -0.0020581223] [-5.7695365 0.56172615 0.42718312 0.5075183 -0.0053519593 -0.051944066 -0.0784053 -0.15863807 0.0194847 0.07579792 -0.0040507503 0.047320887 -0.06788705] [-4.479194 0.60448015 -0.023940029 0.72012097 -0.27436194 -0.27277648 -0.09876808 -0.44449094 0.0144173205 -0.070541255 -0.19324258 0.16177692 0.03553779] [-4.9692936 0.4156502 -0.052754153 0.89570373 -0.06322803 -0.26886335 -0.15127186 -0.4902935 0.0055838367 0.11534414 -0.26112297 -0.082741804 0.21346797]])

(def white [[-7.8504286 1.3340483 0.5723612 0.6437334 0.48397896 0.3997944 0.07580046 -0.12844613 -0.07540974 -0.045615453 -0.19826387 -0.32374656 -0.2382667] [-7.892995 1.4939749 0.78118867 0.6727165 0.5564311 0.42893746 0.08004559 -0.27921632 -0.117697075 -0.1517725 -0.23916045 -0.29073116 -0.21471097] [-7.239464 1.8642225 0.8524318 0.7592755 0.615017 0.33718935 -0.10377988 -0.41319746 -0.22692536 -0.18786193 -0.30483946 -0.3267012 -0.21816769] [-7.1098995 1.7774456 0.7975849 0.6772721 0.5794624 0.3411382 -0.035828557 -0.28022853 -0.27381912 -0.12286368 -0.2925267 -0.34665942 -0.31910393] [-7.784048 1.6536349 0.9055744 0.7680038 0.7312296 0.50075936 -0.045940924 -0.40698576 -0.4324281 -0.19218439 -0.22571723 -0.33744103 -0.26182562] [-7.3404484 1.913166 0.93650955 0.8079652 0.6138412 0.34715447 -0.12412158 -0.39228833 -0.3671494 -0.24681863 -0.18071255 -0.2661737 -0.26722503] [-6.229079 2.0142148 0.88400567 0.73616624 0.39566806 0.24716517 0.019492416 -0.21381485 -0.252646 -0.27917743 -0.31597146 -0.3373598 -0.3495555] [-6.497983 2.176212 0.89198387 0.80938756 0.5198279 0.29187918 -0.24082203 -0.4244571 -0.33462265 -0.11368636 -0.2440372 -0.44079402 -0.2422348] [-5.9522166 1.9751008 0.64848924 0.6976764 0.5698151 0.31414723 -0.17111558 -0.35855204 -0.21712251 -0.11821997 -0.33060753 -0.46911988 -0.30605897] [-5.8607354 2.1954415 0.73026186 0.7706635 0.82629305 0.6034744 -0.4060522 -0.70172405 -0.20915413 -0.07912959 -0.385297 -0.64256126 -0.32989475] [-5.889198 2.0638552 0.51270455 0.6245376 0.8954334 0.57824177 -0.41594526 -0.8879675 -0.30329934 -0.030442473 -0.26060057 -0.4177201 -0.19834165] [-4.676306 2.1519525 0.38671854 0.5061821 0.78921604 0.50776935 -0.3500278 -0.637926 -0.30586016 -0.013469772 -0.34727105 -0.57480156 -0.345476] [-5.2992377 2.384287 0.6269172 0.5523381 0.7337344 0.45640334 -0.53164256 -0.8380295 -0.35766625 0.018123774 -0.20869051 -0.5576121 -0.22610839] [-4.671707 2.0967085 0.5454179 0.5224711 0.59804106 0.34962565 -0.41888943 -0.62728405 -0.3048815 -0.08659612 -0.3515953 -0.54662925 -0.32920444] [-4.58736 2.3608754 0.545971 0.74132013 0.6495426 0.32760763 -0.78557146 -0.8748016 -0.23879051 0.08436415 -0.20786595 -0.59782016 -0.22747354] [-4.7878203 2.227515 0.472919 0.56318337 0.6564163 0.23529716 -0.70276374 -0.7961773 -0.3539019 0.1367043 -0.16391312 -0.46401823 -0.2526527] [-4.051376 2.2769814 0.33902577 0.6512441 0.69621843 0.26727495 -0.6075743 -0.99096555 -0.4365002 0.031594835 -0.13568601 -0.49402815 -0.3201878] [-3.5434713 2.4218714 0.20950665 0.33648685 0.53648365 0.33169356 -0.74553627 -0.9694449 -0.31540722 0.116881944 -0.15887158 -0.46866 -0.24993518] [-3.6081605 2.34486 0.23625438 0.32996854 0.53271925 0.36122072 -0.6391325 -0.9387737 -0.37368298 0.058233723 -0.26031697 -0.48917022 -0.27700046] [-3.1819375 2.615103 0.09195992 0.48650312 0.50857615 0.117531344 -0.74567306 -0.9663233 -0.45699242 0.18820755 -0.09191144 -0.53303987 -0.19163917] [-3.4101055 2.4871085 0.00504543 0.34986216 0.47285277 0.08692919 -0.7372066 -0.9005595 -0.30876148 0.1487179 -0.1084291 -0.401473 -0.25392726] [-2.7474675 2.5951307 -0.09173818 0.36279702 0.51681304 -0.013824364 -0.7824987 -0.96380657 -0.31127527 0.16478524 -0.11539216 -0.30706817 -0.31823844] [-2.2268553 2.5235262 -0.13479191 0.04868524 0.27589467 -0.11411818 -0.68209463 -0.6264859 -0.13612202 0.031529676 -0.19638945 -0.42877713 -0.22413859] [-2.748419 2.6725905 -0.20976067 0.17097044 0.3314223 -0.16948046 -0.72991395 -0.67648447 -0.24616173 0.09832653 -0.20528193 -0.40689182 -0.16064486] [-1.8370396 2.7801013 -0.5894985 -0.014418364 0.1579378 -0.16506684 -0.6168486 -0.59525067 -0.1287482 0.080162235 -0.22153255 -0.18413146 -0.19073421] [-2.3854167 2.6403973 -0.5424469 0.049456373 0.13675265 -0.26295277 -0.585723 -0.5638397 -0.18203427 -0.008330271 -0.11808223 -0.17188784 -0.33196306] [-1.6534789 2.7293262 -0.7340299 0.19897117 0.10754501 -0.45188233 -0.385916 -0.5054583 -0.24877992 -0.026814118 -0.08923546 -0.22016008 -0.4013639] [-1.8703748 2.645083 -0.780674 0.059674926 0.020276524 -0.35433164 -0.32664254 -0.41104668 -0.15604484 0.08469664 -0.09951197 -0.34787035 -0.37248197] [-1.6549077 2.6744313 -0.8069598 0.09799996 0.02158411 -0.4117198 -0.42306674 -0.3441334 -0.13036178 -0.018808745 -0.046332307 -0.27708402 -0.5915325] [-1.516544 2.5520139 -0.9922014 -0.1034867 0.06844533 -0.18315867 -0.20427354 -0.31276914 -0.123163916 0.1174109 -0.16923 -0.44438696 -0.34566212] [-1.7772406 2.4819348 -0.9883498 0.013068538 0.05057112 -0.22219978 -0.17957695 -0.39726844 -0.2063991 0.10944356 -0.21381235 -0.5824065 -0.43577138] [-1.9860939 2.6774392 -0.57250434 -0.09430573 -0.31061447 -0.18501432 -0.020361053 -0.30623436 -0.19806829 -0.0010760343 -0.20748995 -0.27552536 -0.41652605] [-2.553951 2.4966857 -0.53185475 -0.16741571 -0.1651483 -0.046244755 -0.14267367 -0.49102798 -0.1796006 -0.0503211 -0.2393774 -0.37859926 -0.54132175] [-2.3649273 2.8878622 -0.67957604 -0.4885835 0.06809635 0.23340362 -0.086921625 -0.31994814 -0.14557539 -0.034665335 -0.39335078 -0.5551129 -0.35616335] [-2.984599 2.6528113 -0.63661844 -0.6749431 -0.0023162444 0.52199155 0.008966299 -0.3097017 -0.031774074 -0.077088825 -0.43441164 -0.50377077 -0.36213788] [-2.5530794 2.8600984 -0.537647 -0.6566883 -0.012420056 0.34084496 -0.048796494 -0.13857259 0.06912394 -0.22682747 -0.47492033 -0.46746358 -0.27321023] [-2.566146 2.490861 -0.49221033 -0.7407012 -0.121878535 0.43234205 0.057528153 -0.22293353 -0.1186638 -0.16506504 -0.31926087 -0.40982777 -0.1962898] [-2.6064155 2.7965121 -0.52852494 -0.6416982 -0.25820905 0.38437787 0.17088239 -0.21476986 -0.0526727 -0.1800906 -0.3496764 -0.392609 -0.2677884] [-2.8285177 2.287346 -0.65068376 -0.5039985 -0.11478475 0.6480137 0.18026167 -0.31401885 0.031930394 -0.2604405 -0.51719356 -0.19383073 -0.22649108] [-2.706429 2.3535795 -0.70025396 -0.48799926 -0.20924677 0.68998694 0.12522316 -0.41284388 0.16228184 -0.13066785 -0.58732635 -0.18387786 -0.30487448] [-2.8374732 2.3680782 -0.6232895 -0.6562776 0.064519025 0.9207613 0.043000497 -0.46429536 -0.038034797 -0.15343042 -0.4114854 -0.16786233 -0.28370202] [-3.0086496 2.1231294 -0.76229686 -0.6006361 0.11796931 0.74604714 -0.002912526 -0.3303452 -0.01001992 -0.13879818 -0.33352587 -0.16546446 -0.29566374] [-2.9856775 2.2011008 -0.8185238 -0.658603 0.33325684 0.9092147 -0.067200564 -0.19838446 0.051212475 -0.13796425 -0.23617344 -0.20696296 -0.1823469] [-3.5119762 1.9204553 -0.58404744 -0.69548476 0.22566572 0.708987 0.0430472 -0.25261673 0.014833353 -0.16684969 -0.19123797 -0.047177132 -0.11662339] [-3.2693408 2.1761074 -0.64964825 -0.6625099 0.3100771 0.8420456 0.037291277 -0.23288845 -0.05970272 -0.24182442 -0.33778912 -0.07045669 -0.046890225] [-3.6765614 1.9628584 -0.7665959 -0.6757057 0.31331766 0.6991008 -0.16864067 -0.27442572 0.19736972 0.03475154 -0.30356172 -0.15287663 -0.10916917] [-3.5077894 1.9599646 -0.7539191 -0.54677886 0.503493 0.79703766 -0.14331645 -0.3622417 0.16867712 -0.006303984 -0.26548153 -0.23692733 -0.0048349835] [-3.832929 1.6955498 -0.7526641 -0.5206122 0.6465648 0.8185503 -0.19654207 -0.35248795 0.2449269 -0.15850027 -0.32184374 -0.1725365 -0.070308395] [-3.8293848 1.6862489 -0.6685485 -0.4677891 0.43123797 0.83508366 -0.2597625 -0.32424623 0.2147896 -0.028900743 -0.327185 -0.010464364 -0.00755594] [-3.6611624 1.809445 -0.8718997 -0.5773438 0.32382563 0.76919687 -0.015819227 -0.26507658 0.087347746 -0.14178419 -0.30159196 -0.02247557 -0.09813184] [-4.10057 1.8197674 -0.8293544 -0.5409513 0.4033654 0.7102221 -0.051378373 -0.3775088 0.10309694 0.030265333 -0.21269135 0.03787436 0.0053932625] [-3.5287461 1.6815672 -1.3066891 -0.4197298 0.6401443 0.88070476 0.0065142703 -0.257104 0.055745475 -0.15625966 -0.37013608 -0.06454839 -0.17295092] [-4.235724 1.4584733 -0.6981939 -0.3584977 0.33589277 0.6129199 -0.20797138 -0.3383816 0.10418588 0.12111292 -0.2150163 -0.006409634 -0.021488782] [-3.8713102 1.6785693 -1.0115526 -0.7766327 0.3769753 0.9080043 -0.008558934 -0.34066898 0.105658285 -0.08062795 -0.38393024 -0.038624123 -0.07625599] [-2.3366158 1.6775991 -1.4170014 -0.81390315 0.38752848 1.1950771 0.10550703 -0.3138573 0.21507429 0.024048934 -0.4959802 0.07003751 -0.02040607] [-4.202405 1.3101007 -1.083475 -0.5404595 0.41880286 0.9553429 0.016006786 -0.46057925 0.17977701 0.10019332 -0.3363674 0.24219306 0.13561817] [-5.0757394 1.2918795 -0.90903103 -0.5602725 0.24937414 0.6672318 0.1526117 -0.22232792 0.028205313 -0.04550312 -0.30354437 -0.04340541 -0.08323479] [-5.3863 1.1751782 -0.8363065 -0.5614074 0.259595 0.8199707 0.18882743 -0.24315976 -0.09433894 0.022867976 -0.0958404 -0.062274244 0.024939772] [-5.5345645 1.2745571 -0.6074506 -0.54274386 0.39353704 0.81406033 0.11708032 -0.37669075 -0.25821796 -0.065837644 -0.237481 -0.059670947 -0.10624312] [-5.658738 1.1312863 -0.78255934 -0.6490152 0.37200835 0.83016455 0.17251574 -0.36188385 -0.15763637 -0.008614551 -0.20095536 -0.10406723 -0.050503585] [-5.876716 1.0760989 -0.69952786 -0.46645552 0.37098262 0.7470382 0.17020954 -0.26031694 -0.18436413 -0.1614543 -0.26444718 -0.03106965 -0.120500885] [-6.0864096 0.900912 -0.57335585 -0.49413374 0.34518492 0.67008424 0.062114757 -0.2634443 -0.18187448 0.011732328 -0.15352312 -0.15143608 -0.049587138] [-6.1707554 0.8355765 -0.71978474 -0.57564694 0.35901573 0.79019624 0.27988634 -0.17819102 -0.18889259 -0.00994219 -0.1397835 -0.006424722 -0.024574948] [-6.209894 0.7845279 -0.543087 -0.3397095 0.41616908 0.7378603 0.22264504 -0.29213184 -0.20391189 -0.024625568 -0.14622715 0.12552688 0.12611456] [-6.0055375 0.87399846 -0.5487651 -0.37413168 0.33305877 0.74455637 0.22392736 -0.28316745 -0.22710966 8.9843175E-4 -0.10585266 -0.07909913 -0.05410068]])

(def white2 [[-6.5903387 1.4944214 1.1162411 0.7232353 0.020080728 -0.20280151 -0.33106306 -0.3223758 -0.05848198 -0.01017162 -0.16055818 -0.085024245 -0.08271212] [-7.0870214 1.2159567 0.96208334 0.6285323 0.111511946 0.064056344 -0.15571247 -0.28960195 -0.057034854 -0.05155784 -0.12843828 -0.06354535 -0.09379416] [-6.727273 1.2225237 0.9024383 0.59351987 0.062116805 -0.06275578 -0.18880038 -0.13660197 -0.047214936 -0.07517786 -0.03958462 -0.028426828 -0.2525225] [-5.8511286 1.7929279 0.9820785 0.5544767 -0.05758002 -0.25282305 -0.17187959 -0.29341725 -0.13973519 -0.120652474 -0.08392294 -0.07400605 -0.19234912] [-5.9461436 1.9470129 1.1251273 0.5999143 -0.33701795 -0.33620092 -0.14872256 -0.2174097 -0.103428304 -0.14423792 -0.27713114 -0.20250483 -0.20293273] [-5.582458 2.1377673 1.1126708 0.39731693 -0.48223865 -0.41211286 -0.16635644 -0.2726144 -0.046394862 -0.060493752 -0.19384731 -0.22612402 -0.24469313] [-5.146277 2.2828708 0.9213954 0.27363732 -0.4095057 -0.44711655 -0.27172664 -0.23288755 -0.11850571 -0.026873458 -0.24601871 -0.14224236 -0.25094485] [-5.243623 2.3120613 1.3710454 0.49413958 -0.72495747 -0.5026791 -0.3130851 -0.23426315 -0.05641024 -0.13964285 -0.2532782 -0.1559357 -0.22272438] [-4.2492757 2.2414298 1.1573459 0.4288677 -0.7341564 -0.52927125 -0.19530389 -0.39371878 -0.14584933 -0.047074597 -0.3267316 -0.12269719 -0.2511562] [-3.6357775 2.3386474 1.0654373 0.39102298 -1.0841947 -0.5239703 -0.14886479 -0.35566875 -0.14921843 -0.12912418 -0.2341574 -0.15718429 -0.19780424] [-2.4687672 2.211367 0.60652095 0.16626826 -0.8742955 -0.59643435 -0.23129468 -0.36198002 -0.06717949 0.008697378 -0.15192874 -0.08563746 -0.1085753] [-2.2367506 2.233729 0.7853269 0.14859952 -1.2061889 -0.77474874 0.06789587 -0.37845886 -0.19567694 0.15138035 -0.23388559 -0.10462883 0.03961172] [-1.5732633 2.0419972 0.7591085 -0.04481383 -1.5980908 -0.7039145 0.42663738 -0.36513045 -0.25153875 0.09888191 -0.15597402 -0.17540295 0.11045391] [-0.77491766 1.6648072 0.59816766 -0.31777874 -1.5845406 -0.6432773 0.52174264 -0.2734242 -0.18093884 -0.04110719 0.024895098 -0.123472646 0.12042913] [-0.27303806 1.5771259 0.2164367 -0.3669861 -1.4839339 -0.5231245 0.6052706 -0.39416507 -0.2653498 0.055072688 0.09446296 -0.015968204 0.11691017] [0.18531714 1.63643 -0.23918408 -0.17837058 -1.4083225 -0.35293525 0.59119296 -0.6285913 -0.3451857 0.1692734 0.11733945 0.022079565 0.014600807] [0.3964331 1.5495647 -0.2797798 -0.21261726 -1.3136125 -0.20548348 0.48794633 -0.70255595 -0.30587626 0.068669975 0.3349268 0.013019551 -0.19212233] [0.63187075 1.4136022 -0.6009777 0.15630214 -1.1438637 -0.30094257 0.23533301 -0.61860305 -0.22384037 0.0716366 0.2143028 -0.021441376 -0.20083275] [0.61338955 1.5093524 -0.9186077 0.2005509 -0.7515028 -0.41110677 -0.064123675 -0.57029355 -0.054522723 0.15533248 0.13256373 -0.03799561 -0.27830806] [0.518225 1.35487 -1.0596503 0.40685114 -0.6287013 -0.52553517 -0.25002298 -0.56075 0.082730055 0.2399454 0.013289047 -0.0077419565 -0.13797757] [0.52827406 1.1843008 -0.9985643 0.63093853 -0.62265414 -0.7154809 -0.2982896 -0.4441981 0.033287197 0.05447526 -0.029224027 -0.012914047 -0.06346278] [0.24424548 1.0835205 -0.93110144 0.9091853 -0.65281355 -0.8495676 -0.34207797 -0.34346798 -0.092121445 -0.09971217 -0.113896 0.05770067 -0.08119975] [0.41551882 0.7444717 -0.798485 1.234209 -0.51990676 -0.9120572 -0.15620756 -0.411042 -0.10226691 -0.26716506 -0.10090728 0.21924572 -0.14476842] [0.14511292 0.76714 -0.7710981 1.3838828 -0.3878026 -1.0107636 -0.031012308 -0.40978998 -0.058353774 -0.39241913 -0.21507277 0.040093753 -0.21581273] [-0.1887777 0.8047804 -0.65496165 1.4988861 -0.5323779 -0.9250368 0.0740592 -0.30225357 -0.25313058 -0.5529599 -0.18074827 0.1490966 -0.37344325] [-0.46783867 0.76818275 -0.52606726 1.4014909 -0.45779744 -0.91310877 0.15530194 -0.32262513 -0.44856688 -0.37870666 -0.1914415 0.18250729 -0.37245822] [-0.54975367 0.51820326 -0.4332655 1.4935765 -0.5803855 -0.6279338 -0.055197947 -0.37413388 -0.27042827 -0.31039742 -0.17257509 -0.046308108 -0.23077284] [-1.1320243 0.5521937 -0.38368526 1.4047139 -0.32807532 -0.64558274 -0.10833084 -0.4826271 -0.24857375 -0.38385895 -0.039564103 -0.07994683 -0.2738839] [-1.8798121 0.3789494 -0.45528555 1.5232676 -0.28535345 -0.52483237 -0.09495162 -0.45790437 -0.26417577 -0.39167365 -0.05011885 -0.1730408 -0.3331673] [-1.746134 0.17208631 -0.4646847 1.8955207 -0.3555595 -0.45083553 -0.032996874 -0.24102135 -0.15937954 -0.42075765 -0.113830715 -0.10773155 -0.24995388] [-3.2903817 0.35258555 -0.3352249 1.2516094 -0.15647176 -0.431442 0.036534026 -0.15381517 -0.23036338 -0.18501268 -0.009083757 -0.13621956 -0.20526019] [-4.4105787 0.42724168 -0.096757516 1.1393815 -0.338204 -0.4709246 0.016837051 -0.24745989 -0.175468 -0.13360825 -0.0718896 -0.14076357 -0.2887894] [-4.6944547 0.34914526 0.029787598 0.8136378 -0.3703089 -0.4407556 -0.028896268 -0.026810993 -0.13981707 -0.10588877 0.006715844 -0.04609474 -0.1337351] [-4.881442 0.3446501 0.05200643 0.5008439 -0.083235145 -0.3788095 -0.10377503 -0.084509574 -0.19834587 0.0071801925 0.110035665 -0.114769734 -0.0753177]])

(def green [[-2.9309995 1.1392828 -1.3220656 -0.41029587 -0.36914045 0.10924642 -0.67076445 -0.8398166 -0.54977816 0.035628393 0.11908014 -0.040685426 0.12762731] [-4.0043406 0.93116736 -1.16346 -0.5768397 -0.20058914 0.19898322 -0.6049666 -0.8444141 -0.6241257 0.062837265 0.09410158 -0.019146817 0.043580398] [-4.2593613 1.1207256 -0.682069 -0.2480072 0.22886172 0.65573233 -0.20950122 -0.50347054 -0.28718507 0.054130554 -0.026142787 -0.14905545 -0.07033819] [-3.5045054 1.986656 -0.16731355 -0.15776363 0.20759478 0.30650795 -0.563695 -0.6751305 -0.26977506 -0.019936446 -0.06885472 -0.136753 -0.060456473] [-3.420378 2.0449092 -0.3844174 -0.46728146 0.26024258 0.44499683 -0.55937266 -0.58296335 -0.23838447 -0.1219583 -0.18425013 -0.16461001 0.07914327] [-1.9553593 2.398839 -0.83122826 -0.631874 0.32152602 0.46291906 -0.6635974 -0.6241465 -0.11952016 -0.12847582 -0.26068723 -0.09958649 0.0037254735] [-1.1705021 2.268543 -0.8184381 -0.55581427 0.29923505 0.43058148 -0.70072055 -0.6204086 -0.18774788 -0.062933885 -0.23644872 -0.1554831 -0.04400013] [-1.2857395 2.521101 -0.7595446 -0.7348998 0.40141672 0.4873063 -0.82818973 -0.61754614 -0.29783607 0.019915082 -0.21609578 -0.17228214 -0.01241043] [-1.1070595 2.4168248 -0.6524032 -0.7323666 0.27583894 0.6147189 -0.96592635 -0.61362356 -0.16144243 0.04510761 -0.3061525 -0.20035714 0.07871504] [-1.0559067 2.3719645 -0.679572 -0.6954558 0.33673015 0.57526773 -1.0286703 -0.5674487 -0.19802514 0.04391147 -0.24308234 -0.19834341 0.034457054] [-0.9162654 2.3264284 -0.8112359 -0.6453077 0.45886934 0.42922327 -0.964856 -0.5489105 -0.16207042 -0.02609435 -0.21133403 -0.18148752 0.0031863847] [-0.7765047 2.2131753 -0.811841 -0.5374052 0.4152883 0.41624573 -0.9199378 -0.6235463 -0.117446996 0.035268117 -0.23509753 -0.21820366 0.031128988] [-1.2750891 2.3108609 -0.6230762 -0.631108 0.4372593 0.6324143 -1.1663439 -0.61895275 -0.094526045 0.142404 -0.26823807 -0.24891293 0.10434204] [-1.0629464 2.095082 -0.6378265 -0.5033227 0.44091904 0.5182498 -1.1686805 -0.590815 0.08269239 0.032557644 -0.2717188 -0.107499145 -0.011750136] [-1.0379982 2.1603239 -0.74237025 -0.41518837 0.49900994 0.37794945 -1.115432 -0.6125327 0.19099057 -0.015678488 -0.30215228 -0.087225586 -0.02821074] [-0.85523516 1.9575917 -0.81753135 -0.14964946 0.4959162 0.22408941 -1.117463 -0.5769654 0.19118921 0.02495496 -0.31441844 -0.10821814 -0.014092399] [-0.9126841 1.8089168 -0.65652657 -0.1064773 0.61350304 0.13496469 -1.297093 -0.37956858 0.21149847 -0.08504623 -0.31593183 -0.0171162 0.09775053] [-1.0289167 1.8298819 -0.7415418 -0.02583418 0.7022959 -0.034074083 -1.2544158 -0.27803627 0.20598814 -0.21538822 -0.22599098 0.025379399 0.037807804] [-0.8024726 1.7047563 -0.7958283 0.13207209 0.6555623 -0.25766715 -1.107278 -0.1483168 0.18974197 -0.31113434 -0.20268084 7.5862743E-4 -0.040111247] [-0.9913201 1.5749869 -0.8270057 0.4380818 0.5007498 -0.45745426 -1.0243689 -0.07271971 0.21081685 -0.3725163 -0.0854485 -0.07148687 -0.18629892] [-1.0139196 1.3488277 -0.78868806 0.4874667 0.26484483 -0.4514345 -0.7905668 -0.07059555 0.10498835 -0.37697783 0.07494516 -0.14130779 -0.20458263] [-1.1639633 1.1072358 -0.65556115 0.7764548 -4.2452005E-4 -0.70956403 -0.423925 -0.033467434 0.060995243 -0.27102593 0.068756215 -0.1926821 -0.22864746] [-1.1650561 1.0527728 -0.80526507 0.82329005 -0.15623142 -0.56022483 -0.23046853 -0.003745265 0.16202685 -0.34970272 0.18718581 -0.08533066 -0.3154102] [-1.1257896 0.92770237 -0.68495363 0.85099196 -0.363515 -0.45793226 -0.14477725 -0.105768256 0.34432495 -0.3707015 0.15369806 -0.13320164 -0.065010056] [-0.98457295 0.90153646 -0.69330376 1.1636906 -0.4980363 -0.46571854 0.034616757 -0.2568163 0.33902824 -0.4857592 0.07252929 -0.20590022 0.011736543] [-1.4851965 0.953329 -0.6220844 1.2306191 -0.41328606 -0.55980325 0.2430201 -0.15051638 -0.077098064 -0.28142944 -0.10303949 -0.13251296 0.020016875] [-1.2446723 0.8370285 -0.6741645 1.2726076 -0.4880636 -0.530321 0.386866 -0.33980912 -0.10150507 -0.24050023 -0.111170724 -0.03164825 -0.005541935] [-1.314931 0.867302 -0.696366 1.2540343 -0.4453845 -0.483159 0.29339597 -0.40050665 -0.06011704 -0.23189123 -0.14342159 -0.0010421171 0.013192361] [-1.7318491 0.7932535 -0.5873631 1.3883113 -0.4360063 -0.34232768 0.23638804 -0.47935808 0.03331105 -0.34724173 -0.22930224 0.10887364 -0.023204435] [-1.8377424 0.87764055 -0.5223758 1.3456138 -0.6564302 -0.39300758 0.2938165 -0.46480462 0.03686923 -0.16984083 -0.22672835 0.023428367 -0.11471498] [-2.1682441 0.82479364 -0.5007977 1.2463357 -0.61922085 -0.3517687 0.43600392 -0.34997773 -0.12518081 -0.1892276 -0.17220215 -0.12973359 0.06251487] [-2.435716 0.50759745 -0.48285255 1.4122443 -0.66792965 -0.31719086 0.41863027 -0.4070405 0.058097553 0.051190488 -0.19735566 -0.3613499 0.054050002] [-2.7855818 0.33559257 -0.47349653 1.2705907 -0.7355237 -0.2407262 0.4987754 -0.42375106 0.097899355 0.062435515 -0.15010275 -0.26038012 -0.059791144] [-3.3054817 0.2788373 -0.2702929 1.4898837 -0.53147054 -0.15179266 0.42319134 -0.47619906 -0.1902215 -0.06099444 -0.110523805 -0.26648676 -0.0143701] [-2.9441392 0.3408034 -0.23099796 1.533663 -0.7165637 -0.4169388 0.34821543 -0.4629034 -0.17163347 -0.100242026 -0.044934127 -0.25082052 -0.103017226] [-3.4040742 0.2825419 -0.24009517 1.4675845 -0.4893844 -0.35886317 0.37884453 -0.5043108 -0.30458996 -0.077658206 -0.027752582 -0.0976467 -0.10275236] [-3.9603581 0.30479184 -0.10318173 1.4336286 -0.14017095 -0.31005922 0.20240867 -0.43169963 -0.3195393 -0.08225491 -0.087170534 -0.18835066 -0.02242439] [-4.6542163 0.27448702 -0.22171405 1.020998 -6.280824E-4 -0.19297583 0.19750278 -0.39341953 -0.1807335 0.024973832 -0.17730105 -0.16952004 -0.0033131938] [-4.983869 0.46211204 0.04411938 0.9961215 0.30096337 0.008651405 0.20513289 -0.052428287 -0.1565614 -0.027519496 -0.2666374 -0.26210096 -0.034376796] [-4.9549556 0.5833624 0.031134069 0.815408 0.22579245 0.07615087 0.29008913 -0.02492876 -0.24407636 -0.10750164 -0.22138503 -0.1955306 -0.048702504] [-5.1132784 0.5732662 -0.035096645 0.6097511 0.21949287 0.14292921 0.13601159 -0.112937234 -0.20182467 -0.08139891 -0.15480548 -0.09536719 -0.054482993] [-5.242926 0.64033186 0.049475327 0.32524738 0.15090774 0.044333227 0.22243129 -0.030349152 -0.11505682 -0.032135725 -0.14080009 -0.115850136 0.062424265] [-5.4767537 0.51555145 -0.12694332 0.31093895 0.28014487 0.112849236 0.13161409 0.07541663 -0.16725928 -0.08015694 -0.107493155 -0.15992343 0.11899228] [-5.592084 0.52834105 0.06723343 0.38402212 0.268716 0.21986312 0.19610572 -0.039586894 -0.020757185 -0.04235425 -0.15145877 -0.06519083 0.1287586] [-5.6830935 0.46656886 0.055653468 0.26209432 0.34370205 0.318669 0.20187415 -0.021705175 -0.008733973 -0.135059 -0.20409895 -0.17222622 0.0040283133] [-5.7853584 0.4234571 -0.050116137 0.2450388 0.30869555 0.26094756 0.17601918 0.037746172 0.057949837 -0.10321234 -0.20589298 -0.061388195 -0.11530998] [-5.8809443 0.24840884 -0.16145526 0.22177145 0.4375302 0.20548199 0.26086172 0.14384995 -0.09340658 -0.11238463 -0.14856747 -0.0433744 0.093870685] [-5.5871863 0.15980439 -0.26244774 0.45219368 0.23708248 0.25185412 0.21374884 -0.058311958 0.024551498 0.048256613 -0.15049143 0.12502609 0.14628309] [-5.3575993 0.3150048 -0.2575726 0.547975 0.106479526 0.2703017 0.16425689 -0.14440462 0.20711353 0.11875413 -0.20968439 0.010391805 0.09780305] [-5.8552556 0.17257647 -0.34486544 0.31385687 0.20014234 0.2725465 0.1716316 -0.17257765 0.11014521 0.0075454153 -0.26786843 -4.8818925E-4 0.12295227] [-6.381559 0.15699317 -0.38805747 0.08088496 0.1741718 0.057050854 0.059317928 -0.11081393 0.10964589 0.078937136 -0.09474319 0.050452847 0.033556014]])

(def dictionary {:red red
                 :red2 red2
                 :white white
                 :white2 white2
                 :green green})

(def colors {:red "Red"
             :red2 "Red"
             :white "White"
             :white2 "White"
             :green "Green"})

;; Adapted from CMU Sphinx Clojure Transcriber example
(defn initPipeline
  [filepath]
  (let [root "../resources/"]
    (let [logMath (new LogMath 1.0001 true)
          absoluteBeamWidth -1
          relativeBeamWidth 1E-80
          wordInsertionProbability 1E-36
          languageWeight 8.0
          audioSource (new AudioFileDataSource 3200 nil)
          audioURL (new URL (str "file://" filepath))]
      (.setAudioFile audioSource audioURL nil)
      (let [premphasizer (new Preemphasizer 0.97)
            windower (new RaisedCosineWindower 0.46 25.625 10.0)
            fft (new DiscreteFourierTransform -1 false)
            melFilterBank (new MelFrequencyFilterBank 130.0 6800.0 40)
            dct (new DiscreteCosineTransform 40 13)
            cmn (new LiveCMN 12.0 100 160)
            featureExtraction (new DeltasFeatureExtractor 3)
            pipeline [audioSource premphasizer windower fft
                      melFilterBank dct cmn featureExtraction]]
        pipeline))))

(defn average
  [coll]
  (/ (reduce + coll) (count coll)))

(defn getvalue
  [features]
  (if (not (= (class features) DataStartSignal))
    (vec (take 13 (.getValues features))) " "))

;; From O'Reilly's Clojure Programming (Emerick, Carper, and Grand)
(defprotocol Matrix
  "Protocol for 2D vectors"
  (lookup [matrix i j])
  (update [matrix i j value])
  (rows [matrix])
  (cols [matrix])
  (dims [matrix]))

(extend-protocol Matrix
  clojure.lang.IPersistentVector
  (lookup [vov i j]
    (get-in vov [i j]))
  (update [vov i j value]
    (assoc-in vov [i j] value))
  (rows [vov]
    (seq vov))
  (cols [vov]
    (apply map vector vov))
  (dims [vov]
    [(count vov) (count (first vov))]))

(defn vov
  [h w]
  (vec (repeat h (vec (repeat w 0.0)))))

;; From Numeric-Tower examples
(defn- sqr
  "Uses the numeric tower expt to square a number"
  [x]
  (math/expt x 2))

(defn euclidian-squared-distance
  "Computes the Euclidean squared distance between two sequences"
  [a b]
  (reduce + (map (comp sqr -) a b)))

(defn euclidian-distance
  "Computes the Euclidean distance between two sequences"
  [a b]
  (math/sqrt (euclidian-squared-distance a b)))

(defn calc-col1
  [warp incoming template ith jth]
  (+ (lookup warp (- ith 1) 0)
     (euclidian-distance (nth template jth) (nth incoming ith))))

(defn calc-row1
  [warp incoming template ith jth]
  (+ (lookup warp ith (- jth 1))
     (euclidian-distance (nth template jth) (nth incoming ith))))

(defn calc-rest
  [warp incoming template ith jth]
  (+ (apply min (list (lookup warp (- ith 1) jth)
                      (lookup warp ith (- jth 1))
                      (lookup warp (- ith 1) (- jth 1))))
     (euclidian-distance (nth template jth) (nth incoming ith))))

;; Adapted from http://jeremykun.com/2012/07/25/dynamic-time-warping/
(defn dtw
  [incoming template]
  (loop [warpvector (vov (count incoming) (count template))
         ith 0
         jth 0]

   ;; (println ith jth)
    (cond
     ;; [0][0]
     (and (zero? ith) (zero? jth))
     (recur (update warpvector ith jth (euclidian-distance (nth template jth)
                                                           (nth incoming ith)))
            (inc ith)
            (+ jth 0))

     ;; first column
     (and (= ith (- (count incoming) 1)) (zero? jth))
     (recur (update warpvector ith jth (calc-col1 warpvector incoming template ith jth))
            (- ith (- (count incoming) 1))
            (inc jth))
     (and (< ith (count incoming)) (zero? jth))
     (recur (update warpvector ith jth (calc-col1 warpvector incoming template ith jth))
            (inc ith)
            (+ jth 0))
     
     ;; first row
     (and (= jth (- (count template) 1)) (zero? ith))
     (recur (update warpvector ith jth (calc-row1 warpvector incoming template ith jth))
            (inc ith)
            (- jth (- (count template) 2)))
     (and (< jth (count template)) (zero? ith))
     (recur (update warpvector ith jth (calc-row1 warpvector incoming template ith jth))
            (+ ith 0)
            (inc jth))

     ;; rest of matrix
     (and (= ith (- (count incoming) 1)) (> jth 0))
     (recur (update warpvector ith jth (calc-rest warpvector incoming template ith jth))
            (- ith (- (count incoming) 2))
            (inc jth))
     (and (< ith (count incoming)) (< jth (count template)))
     (recur (update warpvector ith jth (calc-rest warpvector incoming template ith jth))
            (inc ith)
            (+ jth 0))

     ;; final position (base case)
     (and (= jth (count template)) (= ith 1)) warpvector)))

(defn recognize
  [incoming]
  (loop [template dictionary
         bestmatch {:color nil :value (Double/POSITIVE_INFINITY)}
         counter (dec (count dictionary))]
    (let [warpdistance (last (last (dtw incoming (val (first template)))))]
      (cond
       (and (= counter 0)
            (< warpdistance (bestmatch :value))) (key (first template))
       (and (= counter 0)
            (> warpdistance (bestmatch :value))) (val (last bestmatch))
       (< warpdistance (bestmatch :value)) (recur (next template)
                                                  (assoc {} :color (key (first template))
                                                            :value warpdistance) 
                                                  (dec counter))
       :else (recur (next template)
                    (assoc {} :color (bestmatch :color) :value (bestmatch :value))
                    (dec counter))))))

(defn -main
  [filepath]
  (let [frontend (new FrontEnd (initPipeline filepath))]
    (.initialize frontend)
    (loop [features (.getData frontend)
           incoming (vec nil)]
      (cond
       (= (class features) DataEndSignal) (println (colors (recognize incoming)))
       (= (class features) DataStartSignal) (recur (.getData frontend)
                                                   (vec nil))
       :else (do
               (recur (.getData frontend)
                      (conj incoming (getvalue features))))))))

